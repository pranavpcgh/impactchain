<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMPACTCHAIN (DEMO) Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
        /* Base Styling */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB; /* gray-50 */
            color: #1F2937; /* gray-800 */
        }
        /* CRED-like green */
        :root {
            --brand-green: #16A34A; /* green-600 */
            --brand-green-light: #22C55E; /* green-500 */
            --brand-green-dark: #15803D; /* green-700 */
            --brand-gray-light: #F3F4F6; /* gray-100 */
            --brand-gray-medium: #E5E7EB; /* gray-200 */
            --brand-gray-dark: #D1D5DB; /* gray-300 */
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--brand-gray-light);
        }
        ::-webkit-scrollbar-thumb {
            background-color: var(--brand-gray-medium);
            border-radius: 20px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: var(--brand-green);
        }
        
        /* Custom card background */
        .card {
            background-color: #ffffff; /* white */
            border: 1px solid #E5E7EB; /* gray-200 */
            transition: all 0.2s ease-out; /* [UX] Add transition */
        }
        .card:hover {
            border-color: #D1D5DB; /* gray-300 */
            box-shadow: 0 8px 16px rgba(0,0,0,0.04); /* [UX] Add shadow */
        }

        /* Animation for fade-in */
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal transitions */
        .modal.hidden {
            display: none;
        }
        .modal-overlay {
            transition: opacity 0.3s ease-out;
        }
        .modal-panel {
            transition: all 0.3s ease-out;
        }
        .modal:not(.hidden) .modal-overlay {
            opacity: 1;
        }
        .modal:not(.hidden) .modal-panel {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        .modal.hidden .modal-overlay {
            opacity: 0;
        }
        .modal.hidden .modal-panel {
            opacity: 0;
            transform: translateY(-20px) scale(0.95);
        }

        /* [FIX] Notification Panel Transition */
        #notification-panel {
            transition: all 0.3s ease-out;
        }
        #notification-panel.hidden {
            opacity: 0;
            transform: translateY(-10px) scale(0.95);
            pointer-events: none;
        }

        /* [UX] Enhanced hover effects */
        .toggle-details-btn, #new-campaign-btn, .donate-btn {
            transition: all 0.2s ease-out;
        }
        .toggle-details-btn:hover, #new-campaign-btn:hover, .donate-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(22, 163, 74, 0.2); /* Green shadow */
        }
        /* [UX] Table row hover */
        .csr-table-row {
            transition: all 0.2s ease-out;
        }
        .csr-table-row:hover {
            background-color: #F9FAFB; /* gray-50 */
            transform: scale(1.01);
            box-shadow: 0 6px 16px rgba(0,0,0,0.05);
            z-index: 1;
            position: relative;
        }
        /* [UX] Document link hover */
        .doc-item {
             transition: all 0.2s ease-out;
        }
        .doc-item:hover {
            border-color: var(--brand-green);
            background-color: #F0FDF4; /* green-50 */
            transform: translateX(3px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.03);
        }

    </style>
</head>
<body class="antialiased">

    <!-- [FIX] Red Demo Banner -->
    <div class="h-10 bg-red-600 text-white flex items-center justify-center sticky top-0 z-20 shadow-lg space-x-4 px-4">
        <i data-lucide="alert-triangle" class="h-5 w-5"></i>
        <span class="font-semibold text-sm hidden sm:inline">This is a DEMO account with demo values.</span>
        <!-- [FIX] View Switcher Dropdown -->
        <select id="view-switcher" class="bg-red-700 border border-red-500 text-white text-sm font-medium rounded-lg focus:ring-red-400 focus:border-red-400 block w-auto p-1.5 ml-4 hover:bg-red-800 transition-colors">
            <option value="user" selected>User View</option>
            <option value="ngo">NGO View</option>
            <option value="csr">CSR View</option>
        </select>
    </div>

    <!-- [FIX] Main Content Area - adjusted for no sidebar and sticky banner -->
    <main class="h-[calc(100vh-2.5rem)] overflow-y-auto bg-gray-50">
        <!-- Top Header -->
        <header class="h-20 bg-white/80 backdrop-blur-sm border-b border-gray-200 flex items-center justify-between px-8 sticky top-0 z-10">
            <div>
                <h1 class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-green-600">
                    IMPACTCHAIN
                </h1>
                <h2 class="text-xl font-bold text-gray-800 -mt-1" id="main-header">User Dashboard</h2>
            </div>
            <div class="flex items-center space-x-4">
                <!-- [FIX] Search button -->
                <button onclick="toggleSearchModal()" class="text-gray-500 hover:text-gray-900 transition-colors rounded-full p-2 hover:bg-gray-100">
                    <i data-lucide="search" class="h-6 w-6"></i>
                </button>
                <!-- [FIX] Notification button -->
                <div class="relative">
                    <button onclick="toggleNotificationPanel()" class="text-gray-500 hover:text-gray-900 relative transition-colors rounded-full p-2 hover:bg-gray-100">
                        <span class="absolute top-1 right-1 h-3 w-3 bg-red-500 rounded-full border-2 border-white"></span>
                        <i data-lucide="bell" class="h-6 w-6"></i>
                    </button>
                    <!-- [FIX] Notification Panel -->
                    <div id="notification-panel" class="hidden absolute top-14 right-0 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 z-30">
                        <div class="flex items-center justify-between p-4 border-b border-gray-200">
                            <h4 class="font-semibold text-gray-900">Notifications</h4>
                            <button class="text-xs text-green-600 font-medium hover:underline">Mark all as read</button>
                        </div>
                        <!-- [FIX] Notification list content is now dynamic -->
                        <div id="notification-list" class="divide-y divide-gray-100 max-h-96 overflow-y-auto">
                            <!-- Content injected by JavaScript -->
                        </div>
                    </div>
                </div>

                <button class="donate-btn bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:shadow-lg transition-all">
                    Donate Now
                </button>
                <div class="flex items-center space-x-3 card rounded-lg p-2 shadow-sm border border-gray-200 hover:shadow-md">
                    <img class="h-10 w-10 rounded-full object-cover" src="https://placehold.co/100x100/16A34A/FFFFFF?text=R" alt="User Avatar">
                    <div>
                        <p class="font-semibold text-gray-900 text-sm" id="profile-name">Rakesh Kumar</p>
                        <p class="text-xs text-gray-500" id="profile-role">Donater</p>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Content changes here -->
        <div id="content-area" class="p-8">
            <!-- Content will be injected by JavaScript -->
        </div>
    </main>

    <!-- 
    ======================================
    HTML TEMPLATES FOR EACH VIEW
    ======================================
    -->
    
    <!-- USER DASHBOARD TEMPLATE -->
    <template id="template-user">
        <div class="animate-fade-in space-y-8">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Total Donated</p>
                        <i data-lucide="landmark" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900 truncate whitespace-nowrap">₹1,25,000</p>
                    <p class="mt-1 text-xs text-gray-500">+ ₹15,000 this month</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Causes Supported</p>
                        <i data-lucide="heart" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">4</p>
                    <p class="mt-1 text-xs text-gray-500">2 active, 2 completed</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Impact Generated</p>
                        <i data-lucide="trending-up" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">28 Lives</p>
                    <p class="mt-1 text-xs text-gray-500">&nbsp;</p> <!-- Keeps height consistent -->
                </div>
            </div>

            <!-- My Causes -->
            <div class="card rounded-xl shadow-lg">
                <h3 class="text-xl font-bold text-gray-900 p-6 border-b border-gray-200">Causes You Support</h3>
                <div class="p-6 space-y-4">
                    <!-- Cause Item 1 -->
                    <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                        <div class="flex flex-col md:flex-row items-start md:items-center justify-between p-4">
                            <div class="flex items-center mb-4 md:mb-0">
                                <!-- [FIX] Replaced img with icon -->
                                <div class="flex-shrink-0 w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center">
                                    <i data-lucide="book-open" class="w-8 h-8 text-green-600"></i>
                                </div>
                                <div class="ml-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Education for Girls</h4>
                                    <!-- [FIX] Removed "Partner:" -->
                                    <p class="text-sm text-gray-500">Hope Foundation</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-6">
                                <div>
                                    <p class="text-xs text-gray-500">Your Donation</p>
                                    <p class="text-lg font-bold text-gray-900">₹50,000</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500">Status</p>
                                    <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                        <span class="h-2 w-2 mr-2 bg-green-400 rounded-full"></span>
                                        In Progress
                                    </span>
                                </div>
                                <button class="toggle-details-btn bg-gray-100 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-gray-200" data-target="#cause-1-details">
                                    Track Impact
                                </button>
                            </div>
                        </div>
                        <div id="cause-1-details" class="details-pane hidden p-6 bg-gray-50 border-t border-gray-200">
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div class="lg:col-span-2">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h5>
                                    <!-- [FIX] Added more milestones -->
                                    <div class="space-y-6">
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="check" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Nov 10, 2025</p>
                                                <h4 class="font-medium text-gray-900">Milestone Achieved</h4>
                                                <p class="text-gray-700">100 new students enrolled with new supplies.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="package" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Oct 28, 2025</p>
                                                <h4 class="font-medium text-gray-900">Supplies Purchased</h4>
                                                <p class="text-gray-700">All books, uniforms, and bags purchased. See invoices in documents.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex">
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="dollar-sign" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Oct 15, 2025</p>
                                                <h4 class="font-medium text-gray-900">Funds Deployed</h4>
                                                <p class="text-gray-700">₹50,000 deployed to Hope Foundation for Milestone 1.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="lg:col-span-1">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Verification Documents</h5>
                                    <div class="space-y-3">
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-check" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Q3 Audit Report.pdf</h5><p class="text-xs text-gray-500">Independent Audit</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="camera" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Student Photos.zip</h5><p class="text-xs text-gray-500">Field Report</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-text" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Gov. Partnership.pdf</h5><p class="text-xs text-gray-500">Legal</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="clipboard-list" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Supply Invoices.xls</h5><p class="text-xs text-gray-500">Financials</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-check-2" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Final Impact.pdf</h5><p class="text-xs text-gray-500">Completion Report</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cause Item 2 -->
                    <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                        <div class="flex flex-col md:flex-row items-start md:items-center justify-between p-4">
                            <div class="flex items-center mb-4 md:mb-0">
                                <!-- [FIX] Replaced img with icon -->
                                <div class="flex-shrink-0 w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center">
                                    <i data-lucide="droplet" class="w-8 h-8 text-green-600"></i>
                                </div>
                                <div class="ml-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Clean Water Project</h4>
                                    <!-- [FIX] Removed "Partner:" -->
                                    <p class="text-sm text-gray-500">AquaLife</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-6">
                                <div>
                                    <p class="text-xs text-gray-500">Your Donation</p>
                                    <p class="text-lg font-bold text-gray-900">₹30,000</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500">Status</p>
                                    <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                        <span class="h-2 w-2 mr-2 bg-green-400 rounded-full"></span>
                                        In Progress
                                    </span>
                                </div>
                                <button class="toggle-details-btn bg-gray-100 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-gray-200" data-target="#cause-2-details">
                                    Track Impact
                                </button>
                            </div>
                        </div>
                        <div id="cause-2-details" class="details-pane hidden p-6 bg-gray-50 border-t border-gray-200">
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div class="lg:col-span-2">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h5>
                                    <!-- [FIX] Added more milestones -->
                                    <div class="space-y-6">
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="image" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Nov 5, 2025</p>
                                                <h4 class="font-medium text-gray-900">Photos Uploaded</h4>
                                                <p class="text-gray-700">On-site photos of the new well installation are available.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="wrench" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Oct 30, 2025</p>
                                                <h4 class="font-medium text-gray-900">Drilling Commenced</h4>
                                                <p class="text-gray-700">The team has broken ground at the new well site.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex">
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="map-pin" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Oct 20, 2025</p>
                                                <h4 class="font-medium text-gray-900">Site Surveyed</h4>
                                                <p class="text-gray-700">Geological survey complete, drilling site confirmed.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="lg:col-span-1">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Verification Documents</h5>
                                    <div class="space-y-3">
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="camera" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">On-site Photos</h5><p class="text-xs text-gray-500">Field Report</p></div></div><i data-lucide="arrow-right" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                         <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-check" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Water Test.pdf</h5><p class="text-xs text-gray-500">Quality Report</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                         <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="users" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Community Sign-off</h5><p class="text-xs text-gray-500">Legal</q></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                         <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="clipboard-list" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Drilling Invoices.xls</h5><p class="text-xs text-gray-500">Financials</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                         <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-text" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Site Permit.pdf</h5><p class="text-xs text-gray-500">Legal</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                     <!-- Cause Item 3 -->
                    <div class="bg-white rounded-lg border border-gray-200 overflow-hidden">
                        <div class="flex flex-col md:flex-row items-start md:items-center justify-between p-4">
                            <div class="flex items-center mb-4 md:mb-0">
                                <!-- [FIX] Replaced img with icon -->
                                <div class="flex-shrink-0 w-14 h-14 rounded-lg bg-green-100 flex items-center justify-center">
                                    <i data-lucide="tree-pine" class="w-8 h-8 text-green-600"></i>
                                </div>
                                <div class="ml-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Reforestation Drive</h4>
                                    <!-- [FIX] Removed "Partner:" -->
                                    <p class="text-sm text-gray-500">Earth Guardians</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-6">
                                <div>
                                    <p class="text-xs text-gray-500">Your Donation</p>
                                    <p class="text-lg font-bold text-gray-900">₹45,000</p>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500">Status</p>
                                    <span class="inline-flex items-center rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-800">
                                        <span class="h-2 w-2 mr-2 bg-gray-400 rounded-full"></span>
                                        Completed
                                    </span>
                                </div>
                                <button class="toggle-details-btn bg-gray-100 text-gray-800 px-4 py-2 rounded-lg font-semibold hover:bg-gray-200" data-target="#cause-3-details">
                                    Track Impact
                                </button>
                            </div>
                        </div>
                        <div id="cause-3-details" class="details-pane hidden p-6 bg-gray-50 border-t border-gray-200">
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                                <div class="lg:col-span-2">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h5>
                                    <!-- [FIX] Added more milestones -->
                                    <div class="space-y-6">
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="check-check" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Sep 1, 2025</p>
                                                <h4 class="font-medium text-gray-900">Project Completed</h4>
                                                <p class="text-gray-700">Final audit complete. 5,000 trees successfully planted.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex pb-6">
                                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center"><div class="h-full w-0.5 bg-gray-300"></div></div>
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="clipboard-check" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Aug 15, 2025</p>
                                                <h4 class="font-medium text-gray-900">Mid-term Report</h4>
                                                <p class="text-gray-700">2,500 trees planted, 98% survival rate. Photos uploaded.</p>
                                            </div>
                                        </div>
                                        <div class="relative flex">
                                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-gray-500 inline-flex items-center justify-center text-white z-10">
                                                <i data-lucide="play" class="h-5 w-5"></i>
                                            </div>
                                            <div class="flex-grow pl-4">
                                                <p class="text-sm text-gray-500 mb-1">Jul 1, 2025</p>
                                                <h4 class="font-medium text-gray-900">Project Started</h4>
                                                <p class="text-gray-700">Planting has begun at the designated site.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="lg:col-span-1">
                                    <h5 class="text-lg font-semibold text-gray-900 mb-4">Verification Documents</h5>
                                    <div class="space-y-3">
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-text" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Gov. Approval.pdf</h5><p class="text-xs text-gray-500">Legal</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-check-2" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Final Report.pdf</h5><p class="text-xs text-gray-500">Completion Report</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="file-check" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Audit Report.pdf</h5><p class="text-xs text-gray-500">Independent Audit</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="camera" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Site Photos (Post).zip</h5><p class="text-xs text-gray-500">Field Report</q></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                        <div class="doc-item flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200">
                                            <div class="flex items-center truncate"><i data-lucide="clipboard-list" class="h-8 w-8 text-green-500 flex-shrink-0"></i><div class="ml-3 truncate"><h5 class="font-semibold text-gray-900 truncate">Sapling Invoices.xls</h5><p class="text-xs text-gray-500">Financials</p></div></div><i data-lucide="download" class="h-5 w-5 text-gray-400 hover:text-gray-900 cursor-pointer flex-shrink-0 ml-2"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <!-- NGO DASHBOARD TEMPLATE -->
    <template id="template-ngo">
        <div class="animate-fade-in space-y-8">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Total Raised</p>
                        <i data-lucide="target" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900 truncate whitespace-nowrap">₹45,00,000</p>
                    <p class="mt-1 text-xs text-gray-500">+ ₹2,50,000 this month</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Active Campaigns</p>
                        <i data-lucide="activity" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">3</p>
                    <p class="mt-1 text-xs text-gray-500">2 new campaigns launched</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Total Donors</p>
                        <i data-lucide="users" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">1,820</p>
                    <p class="mt-1 text-xs text-gray-500">+ 120 new donors</p>
                </div>
            </div>

            <!-- Fundraising Causes -->
            <div class="card rounded-xl shadow-lg">
                <div class="flex items-center justify-between p-6 border-b border-gray-200">
                    <h3 class="text-xl font-bold text-gray-900">Your Fundraising Causes</h3>
                    <button id="new-campaign-btn" class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg flex items-center">
                        <i data-lucide="plus" class="h-5 w-5 mr-2"></i>
                        New Campaign
                    </button>
                </div>
                
                <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Campaign Card 1 -->
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200 space-y-3 transition-all hover:shadow-md hover:border-gray-300">
                        <div class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold text-gray-900">Education for Girls</h4>
                            <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                Active
                            </span>
                        </div>
                        <p class="text-sm text-gray-500">Goal: ₹20,00,000</p>
                        <!-- Progress Bar -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-base font-medium text-green-600">₹15,00,000 Raised</span>
                                <span class="text-sm font-medium text-gray-900">75%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2.5 rounded-full" style="width: 75%"></div>
                            </div>
                        </div>
                        <!-- [FIX] Added Verification Agency -->
                        <p class="text-xs text-gray-500 pt-1">Verification by: <span class="font-medium text-gray-700">TrueImpact Auditors</span></p>
                        <button class="w-full bg-gray-100 text-gray-800 px-4 py-2 mt-2 rounded-lg font-semibold hover:bg-gray-200 transition-all">
                            Manage Campaign
                        </button>
                    </div>
                    
                    <!-- Campaign Card 2 -->
                    <div class="p-4 bg-gray-50 rounded-lg border border-gray-200 space-y-3 transition-all hover:shadow-md hover:border-gray-300">
                        <div class="flex items-center justify-between">
                            <h4 class="text-lg font-semibold text-gray-900">Digital Literacy Program</h4>
                            <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                Active
                            </span>
                        </div>
                        <p class="text-sm text-gray-500">Goal: ₹7,50,000</p>
                        <!-- Progress Bar -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <span class="text-base font-medium text-green-600">₹2,50,000 Raised</span>
                                <span class="text-sm font-medium text-gray-900">33%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-2.5 rounded-full" style="width: 33%"></div>
                            </div>
                        </div>
                        <!-- [FIX] Added Verification Agency -->
                        <p class="text-xs text-gray-500 pt-1">Verification by: <span class="font-medium text-gray-700">Global Verify Solutions</span></p>
                        <button class="w-full bg-gray-100 text-gray-800 px-4 py-2 mt-2 rounded-lg font-semibold hover:bg-gray-200 transition-all">
                            Manage Campaign
                        </button>
                    </div>

                </div>
            </div>
            
            <!-- Grid for Activity and Submissions -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Donation Status & Activities -->
                <div class="lg:col-span-2 card rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-900 p-6 border-b border-gray-200">Donation & Activity Feed</h3>
                    <div class="p-6 space-y-6">
                        <!-- Timeline Item -->
                        <div class="relative flex pb-6">
                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center">
                                <div class="h-full w-0.5 bg-gray-300"></div>
                            </div>
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                <i data-lucide="dollar-sign" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-grow pl-4">
                                <p class="text-sm text-gray-500 mb-1">Nov 11, 2025</p>
                                <h4 class="font-medium text-gray-900">New Donation from Alex Johnson</h4>
                                <p class="text-gray-700">₹15,000 received for 'Clean Water Project'.</p>
                            </div>
                        </div>
                        <!-- Timeline Item -->
                        <div class="relative flex pb-6">
                            <div class="h-full w-10 absolute inset-0 flex items-center justify-center">
                                <div class="h-full w-0.5 bg-gray-300"></div>
                            </div>
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                <i data-lucide="briefcase" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-grow pl-4">
                                <p class="text-sm text-gray-500 mb-1">Nov 9, 2025</p>
                                <h4 class="font-medium text-gray-900">New CSR Partner: TechCorp</h4>
                                <p class="text-gray-700">Pledged ₹50,00,000 for 'Education for Girls'.</p>
                            </div>
                        </div>
                         <!-- Timeline Item -->
                        <div class="relative flex">
                            <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-600 inline-flex items-center justify-center text-white z-10">
                                <i data-lucide="check-check" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-grow pl-4">
                                <p class="text-sm text-gray-500 mb-1">Nov 8, 2025</p>
                                <h4 class="font-medium text-gray-900">Milestone 1 Reached!</h4>
                                <p class="text-gray-700">'Education for Girls' has funded 100 student kits. Time to upload verification!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submission Center -->
                <div class="lg:col-span-1 card rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-900 p-6 border-b border-gray-200">Submission Center</h3>
                    <div class="p-6">
                        <p class="text-gray-700 mb-4">Upload verification reports, photos, and legal documents for your causes.</p>
                        <div class="flex flex-col items-center justify-center w-full">
                            <label for="dropzone-file" class="flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-all">
                                <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                    <i data-lucide="upload-cloud" class="w-10 h-10 text-green-500 mb-3"></i>
                                    <p class="mb-2 text-sm text-gray-500"><span class="font-semibold text-green-600">Click to upload</span> or drag & drop</p>
                                    <p class="text-xs text-gray-400">PDF, PNG, JPG (MAX. 10MB)</p>
                                </div>
                                <input id="dropzone-file" type="file" class="hidden" />
                            </label>
                        </div>
                        <button class="w-full donate-btn bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-5 rounded-lg shadow-md hover:shadow-lg transition-all mt-4">
                            Submit Documents
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <!-- CSR DASHBOARD TEMPLATE -->
    <template id="template-csr">
        <div class="animate-fade-in space-y-8">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Total Contribution</p>
                        <i data-lucide="building" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900 truncate whitespace-nowrap">₹2.5 Cr</p>
                    <p class="mt-1 text-xs text-gray-500">FY 2025</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Projects Funded</p>
                        <i data-lucide="clipboard-list" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">8</p>
                    <p class="mt-1 text-xs text-gray-500">Across 3 NGOs</p>
                </div>
                <div class="card rounded-xl p-6 shadow-lg transition-all hover:shadow-xl hover:scale-[1.02]">
                    <div class="flex items-center justify-between">
                        <p class="text-sm font-medium text-gray-500">Total Impact Score</p>
                        <i data-lucide="gem" class="h-6 w-6 text-green-500"></i>
                    </div>
                    <p class="mt-2 text-3xl font-extrabold text-gray-900">8.2 / 10</p>
                    <p class="mt-1 text-xs text-gray-500">Based on verification data</p>
                </div>
            </div>

            <!-- Portfolio Projects -->
            <div class="card rounded-xl shadow-lg overflow-x-auto">
                <h3 class="text-xl font-bold text-gray-900 p-6 border-b border-gray-200">Funded Project Portfolio</h3>
                <div class="p-0">
                    <table class="w-full text-left min-w-[600px]">
                        <thead class="border-b border-gray-200 bg-gray-50">
                            <tr>
                                <th class="py-4 px-6 text-sm font-semibold text-gray-500">Project</th>
                                <th class="py-4 px-6 text-sm font-semibold text-gray-500">NGO Partner</th>
                                <th class="py-4 px-6 text-sm font-semibold text-gray-500">Total Budget</th>
                                <th class="py-4 px-6 text-sm font-semibold text-gray-500">Status</th>
                                <th class="py-4 px-6 text-sm font-semibold text-gray-500">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="csr-table-row">
                                <td class="py-4 px-6 font-medium text-gray-900">Education for Girls</td>
                                <td class="py-4 px-6 text-gray-700">Hope Foundation</td>
                                <td class="py-4 px-6 font-medium text-gray-900">₹20L</td>
                                <td class="py-4 px-6">
                                    <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                        In Progress
                                    </span>
                                </td>
                                <td class="py-4 px-6">
                                    <button class="text-green-600 font-semibold hover:text-green-500 transition-colors">View Report</button>
                                </td>
                            </tr>
                            <tr class="csr-table-row">
                                <td class="py-4 px-6 font-medium text-gray-900">Clean Water Project</td>
                                <td class="py-4 px-6 text-gray-700">AquaLife</td>
                                <td class="py-4 px-6 font-medium text-gray-900">₹15L</td>
                                <td class="py-4 px-6">
                                    <span class="inline-flex items-center rounded-full bg-green-100 px-3 py-1 text-sm font-medium text-green-800">
                                        In Progress
                                    </span>
                                </td>
                                <td class="py-4 px-6">
                                    <button class="text-green-600 font-semibold hover:text-green-500 transition-colors">View Report</button>
                                </td>
                            </tr>
                            <tr class="csr-table-row">
                                <td class="py-4 px-6 font-medium text-gray-900">Reforestation Drive</td>
                                <td class="py-4 px-6 text-gray-700">Earth Guardians</td>
                                <td class="py-4 px-6 font-medium text-gray-900">₹30L</td>
                                <td class="py-4 px-6">
                                    <span class="inline-flex items-center rounded-full bg-gray-100 px-3 py-1 text-sm font-medium text-gray-800">
                                        Completed
                                    </span>
                                </td>
                                <td class="py-4 px-6">
                                    <button class="text-green-600 font-semibold hover:text-green-500 transition-colors">View Report</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Grid for Impact & Compliance -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Impact by Sector (Simulated Chart) -->
                <div class="card rounded-xl shadow-lg">
                    <!-- [FIX] Added info button and tooltip -->
                    <div class="flex items-center justify-between p-6 border-b border-gray-200">
                        <h3 class="text-xl font-bold text-gray-900">Impact by Sector</h3>
                        <div class="relative group">
                            <i data-lucide="info" class="h-5 w-5 text-gray-400 cursor-pointer"></i>
                            <div class="absolute bottom-full mb-2 right-1/2 translate-x-1/2 w-64 bg-gray-800 text-white text-xs rounded-lg py-2 px-3 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity z-10 pointer-events-none">
                                Calculated based on funds deployed vs. milestones verified by independent auditors.
                                <div class="absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800"></div>
                            </div>
                        </div>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- Chart Item -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <p class="font-semibold text-gray-700">Education</p>
                                <p class="font-semibold text-green-600">45%</p>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full" style="width: 45%"></div>
                            </div>
                        </div>
                        <!-- Chart Item -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <p class="font-semibold text-gray-700">Environment</p>
                                <p class="font-semibold text-green-600">30%</p>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4 mt-1">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full" style="width: 30%"></div>
                            </div>
                        </div>
                        <!-- Chart Item -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <p class="font-semibold text-gray-700">Health & Water</p>
                                <p class="font-semibold text-green-600">25%</p>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-4 mt-1">
                                <div class="bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full" style="width: 25%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Compliance & Reports -->
                <div class="card rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-gray-900 p-6 border-b border-gray-200">Compliance & Reports</h3>
                    <div class="p-6 space-y-4">
                        <button class="doc-item w-full text-left flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <span class="font-semibold text-gray-900">Download FY2025 Aggregate Report</span>
                            <i data-lucide="download-cloud" class="h-6 w-6 text-green-500"></i>
                        </button>
                        <button class="doc-item w-full text-left flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <span class="font-semibold text-gray-900">View All NGO Audits</span>
                            <i data-lucide="file-check" class="h-6 w-6 text-green-500"></i>
                        </button>
                        <button class="doc-item w-full text-left flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200">
                            <span class="font-semibold text-gray-900">8b Compliance Documents</span>
                            <i data-lucide="file-text" class="h-6 w-6 text-green-500"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </template>
    
    <!-- [FIX] Search Modal -->
    <div id="search-modal" class="modal hidden fixed inset-0 z-50 flex items-start justify-center pt-20 p-4">
        <!-- Overlay -->
        <div class="modal-overlay absolute inset-0 bg-black/50 opacity-0" onclick="closeSearchModal()"></div>
        
        <!-- Modal Panel -->
        <div class="modal-panel card rounded-xl shadow-2xl w-full max-w-2xl z-10 opacity-0 transform scale-95">
            <div class="relative">
                <input type="text" class="w-full p-6 text-lg border-0 rounded-xl focus:ring-2 focus:ring-green-500" placeholder="Search for causes, partners, reports...">
                <div class="absolute top-1/2 -translate-y-1/2 right-6">
                    <i data-lucide="search" class="h-6 w-6 text-gray-400"></i>
                </div>
            </div>
            <!-- Can add search results here -->
        </div>
    </div>

    <!-- New Campaign Modal -->
    <div id="new-campaign-modal" class="modal hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <!-- Overlay -->
        <div class="modal-overlay absolute inset-0 bg-black/50 opacity-0" onclick="closeCampaignModal()"></div>
        
        <!-- Modal Panel -->
        <div class="modal-panel card rounded-xl shadow-2xl w-full max-w-2xl z-10 opacity-0 transform scale-95">
            <!-- Modal Header -->
            <div class="flex items-center justify-between p-6 border-b border-gray-200">
                <h3 class="text-xl font-bold text-gray-900">Create New Campaign</h3>
                <button onclick="closeCampaignModal()" class="text-gray-400 hover:text-gray-800 rounded-full p-1 hover:bg-gray-100 transition-colors">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>
            <!-- Modal Body (Form) -->
            <form id="new-campaign-form" class="p-6 space-y-4">
                <div>
                    <label for="campaign-name" class="block text-sm font-medium text-gray-700">Campaign Name</label>
                    <input type="text" id="campaign-name" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500" placeholder="e.g., Winter Shelter Drive">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="campaign-goal" class="block text-sm font-medium text-gray-700">Fundraising Goal (INR)</label>
                        <div class="relative mt-1">
                            <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                <span class="text-gray-500">₹</span>
                            </div>
                            <input type="number" id="campaign-goal" class="block w-full rounded-lg border-gray-300 shadow-sm pl-7 focus:border-green-500 focus:ring-green-500" placeholder="5,00,000">
                        </div>
                    </div>
                     <div>
                        <label for="verification-agency" class="block text-sm font-medium text-gray-700">Verification Agency</label>
                        <input type="text" id="verification-agency" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500" placeholder="e.g., TrueImpact Auditors">
                    </div>
                </div>

                <div>
                    <label for="campaign-milestones" class="block text-sm font-medium text-gray-700">Milestones (one per line)</label>
                    <textarea id="campaign-milestones" rows="3" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500" placeholder="Milestone 1: 100 blankets distributed&#10;Milestone 2: 50 shelter beds funded"></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700">Government Supported?</label>
                    <div class="mt-2 flex space-x-4">
                        <div class="flex items-center">
                            <input id="gov-yes" name="gov-supported" type="radio" class="h-4 w-4 border-gray-300 text-green-600 focus:ring-green-500">
                            <label for="gov-yes" class="ml-2 block text-sm text-gray-900">Yes</label>
                        </div>
                         <div class="flex items-center">
                            <input id="gov-no" name="gov-supported" type="radio" class="h-4 w-4 border-gray-300 text-green-600 focus:ring-green-500" checked>
                            <label for="gov-no" class="ml-2 block text-sm text-gray-900">No</label>
                        </div>
                    </div>
                </div>

                <!-- Modal Footer (Buttons) -->
                <div class="flex justify-end space-x-3 pt-4 border-t border-gray-200 mt-6">
                    <button type="button" onclick="closeCampaignModal()" class="bg-white py-2 px-4 border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all">
                        Cancel
                    </button>
                    <button type="submit" class="donate-btn bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-5 rounded-lg shadow-md hover:shadow-lg transition-all">
                        Create Campaign
                    </button>
                </div>
            </form>
        </div>
    </div>


    <script>
        // Store templates
        const templates = {
            user: document.getElementById('template-user').innerHTML,
            ngo: document.getElementById('template-ngo').innerHTML,
            csr: document.getElementById('template-csr').innerHTML,
        };
        
        // Get content area
        const contentArea = document.getElementById('content-area');
        
        // Get profile elements
        const profileName = document.getElementById('profile-name');
        const profileRole = document.getElementById('profile-role');
        const mainHeader = document.getElementById('main-header');
        // [FIX] Get notification list container
        const notificationList = document.getElementById('notification-list');
        
        // Profile data for switching
        const profiles = {
            user: { name: 'Rakesh Kumar', role: 'Donater', header: 'User Dashboard' }, // [FIX] Renamed
            ngo: { name: 'Hope Foundation', role: 'NGO Partner', header: 'NGO Dashboard' },
            csr: { name: 'TechCorp', role: 'CSR Partner', header: 'CSR Dashboard' },
        };

        // [FIX] Notification content for each view
        const notifications = {
            user: `
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="check" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">Milestone Achieved:</span> 'Education for Girls' just enrolled 100 new students!</p>
                        <p class="text-xs text-gray-500 mt-1">2 hours ago</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="image" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">New Photos:</span> 'Clean Water Project' added new on-site photos.</p>
                        <p class="text-xs text-gray-500 mt-1">1 day ago</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="file-text" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">New Report:</span> An audit report for 'Reforestation Drive' is available.</p>
                        <p class="text-xs text-gray-500 mt-1">3 days ago</p>
                    </div>
                </div>
            `,
            ngo: `
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="dollar-sign" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">New Donation:</span> ₹15,000 from Rakesh Kumar for 'Clean Water Project'.</p>
                        <p class="text-xs text-gray-500 mt-1">1 hour ago</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="briefcase" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">New Partner:</span> TechCorp has pledged ₹50L for 'Education for Girls'.</p>
                        <p class="text-xs text-gray-500 mt-1">6 hours ago</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-red-100 inline-flex items-center justify-center text-red-600 z-10">
                        <i data-lucide="upload-cloud" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">Action Required:</span> Upload verification docs for 'Education for Girls' Milestone 1.</p>
                        <p class="text-xs text-gray-500 mt-1">2 days ago</p>
                    </div>
                </div>
            `,
            csr: `
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="file-check-2" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">Report Ready:</span> The Q3 Aggregate Impact Report for your portfolio is ready for download.</p>
                        <p class="text-xs text-gray-500 mt-1">45 minutes ago</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-green-100 inline-flex items-center justify-center text-green-600 z-10">
                        <i data-lucide="check-check" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">Milestone Verified:</span> Hope Foundation's 'Education for Girls' Milestone 1 has been verified by auditors.</p>
                        <p class="text-xs text-gray-500 mt-1">Yesterday</p>
                    </div>
                </div>
                <div class="p-4 flex space-x-3 hover:bg-gray-50 transition-colors">
                    <div class="flex-shrink-0 w-10 h-10 rounded-full bg-blue-100 inline-flex items-center justify-center text-blue-600 z-10">
                        <i data-lucide="lightbulb" class="h-5 w-5"></i>
                    </div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-800"><span class="font-semibold">New Proposal:</span> 'AquaLife' has submitted a new proposal for 'Clean Water Phase 2'.</p>
                        <p class="text-xs text-gray-500 mt-1">4 days ago</p>
                    </div>
                </div>
            `
        };
        
        function switchView(view) {
            // Update content
            if (templates[view]) {
                contentArea.innerHTML = templates[view];
            }
            
            // Update profile
            if (profiles[view]) {
                profileName.textContent = profiles[view].name;
                profileRole.textContent = profiles[view].role;
                mainHeader.textContent = profiles[view].header;
                
                // Update profile avatar text
                const avatar = profileName.closest('.card').querySelector('img');
                if (avatar) {
                    const initial = profiles[view].name.charAt(0).toUpperCase();
                    avatar.src = `https://placehold.co/100x100/16A34A/FFFFFF?text=${initial}`;
                }
            }

            // [FIX] Update notification panel content
            if (notifications[view] && notificationList) {
                notificationList.innerHTML = notifications[view];
                // We must re-run createIcons for the icons inside the new notification HTML
                lucide.createIcons();
            }
            
            // Re-initialize icons for the main content area
            lucide.createIcons();
        }
        
        // [FIX] Modal Functions
        const campaignModal = document.getElementById('new-campaign-modal');
        const newCampaignForm = document.getElementById('new-campaign-form');
        const searchModal = document.getElementById('search-modal');
        const notificationPanel = document.getElementById('notification-panel');

        function openCampaignModal() {
            if (campaignModal) {
                campaignModal.classList.remove('hidden');
                lucide.createIcons();
            }
        }

        function closeCampaignModal() {
            if (campaignModal) {
                campaignModal.classList.add('hidden');
            }
        }

        function toggleSearchModal() {
            if (searchModal) {
                const isHidden = searchModal.classList.toggle('hidden');
                if (!isHidden) {
                    lucide.createIcons();
                    // Focus the input
                    searchModal.querySelector('input').focus();
                }
            }
        }
        
        function closeSearchModal() {
             if (searchModal) {
                searchModal.classList.add('hidden');
            }
        }
        
        function toggleNotificationPanel() {
            if (notificationPanel) {
                const isHidden = notificationPanel.classList.toggle('hidden');
                 if (!isHidden) {
                    // Icons are now created in switchView, but we call it again
                    // in case the view hasn't changed but panel is re-opened.
                    lucide.createIcons();
                }
            }
        }

        function closeNotificationPanel() {
             if (notificationPanel) {
                notificationPanel.classList.add('hidden');
            }
        }

        
        // Event Delegation for dynamic content (modal and details pane)
        contentArea.addEventListener('click', function(e) {
            // Check for "New Campaign" button click
            const newCampaignBtn = e.target.closest('#new-campaign-btn');
            if (newCampaignBtn) {
                e.preventDefault();
                openCampaignModal();
            }

            // Check for "Track Impact" button click
            const detailsBtn = e.target.closest('.toggle-details-btn');
            if (detailsBtn) {
                e.preventDefault();
                const targetId = detailsBtn.getAttribute('data-target');
                const targetPane = document.querySelector(targetId);
                if (targetPane) {
                    // [UX] Smooth slide toggle
                    if (targetPane.classList.contains('hidden')) {
                        targetPane.classList.remove('hidden');
                        setTimeout(() => {
                             targetPane.style.maxHeight = targetPane.scrollHeight + 'px';
                             targetPane.style.opacity = 1;
                        }, 10);
                        detailsBtn.textContent = 'Hide Details';
                        detailsBtn.classList.add('bg-gray-200');
                    } else {
                        targetPane.style.maxHeight = '0px';
                        targetPane.style.opacity = 0;
                         setTimeout(() => {
                            targetPane.classList.add('hidden');
                         }, 300); // Match transition duration
                        detailsBtn.textContent = 'Track Impact';
                        detailsBtn.classList.remove('bg-gray-200');
                    }
                    lucide.createIcons();
                }
            }
        });

        // Add smooth transition style to details pane
        const styleSheet = document.createElement("style");
        styleSheet.type = "text/css";
        styleSheet.innerText = `
            .details-pane {
                transition: max-height 0.3s ease-out, opacity 0.2s ease-out;
                overflow: hidden;
                max-height: 0px;
                opacity: 0;
            }
        `;
        document.head.appendChild(styleSheet);


        // Handle form submission
        if (newCampaignForm) {
            newCampaignForm.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log('Campaign form submitted');
                closeCampaignModal();
            });
        }

        // [FIX] Click outside listener for modals/panels
        window.addEventListener('click', function(e) {
            // Click outside notification panel
            if (notificationPanel && !notificationPanel.classList.contains('hidden')) {
                const bellIcon = e.target.closest('button[onclick="toggleNotificationPanel()"]');
                if (!notificationPanel.contains(e.target) && !bellIcon) {
                    closeNotificationPanel();
                }
            }
            
            // Click on search modal overlay
            if (searchModal && !searchModal.classList.contains('hidden')) {
                if (e.target.classList.contains('modal-overlay')) {
                    closeSearchModal();
                }
            }
        });


        // Initial load
        window.addEventListener('load', () => {
            // Add event listener for new dropdown
            document.getElementById('view-switcher').addEventListener('change', (e) => switchView(e.target.value));
            
            // Initial view load
            switchView('user');
        });

    </script>
</body>
</html>
